import golly as g
 
inputstr="E9 E10 E11 E12 E13 E14 E15 E15 E22 E15 E7 O-9 E24 E24 O33 O-9 O-9 O-11 O2 E-11 E-11 O-17 O-5 O-30 E9 O39 O28 E-2 E0 O10 E3 E8 E13 E17 E-21 E-32 E-26 E-7 E-3 E-5 O12 E2 E16 E20 O-15 E-27 E-23 E-31 O-23 O-24 O-11 O-31 O-7 E27 E35 E23 O17 E30 E16 E20 O7 O10 O7 O12 O1 O3 E9 O4 O30 O43 E34 O29 O29 O-5 E-31 E-26 E-24 E-26 O-18 O-16 O-14 E-6 E-6 O-14 O-15 O-19 O12 O15 E25 E23 O13 O2 E1 E25 O-9 O-12 E-22 E-20 O-10 O1 E2 E-22"
inputstr="E-8 E-18 E-12 E6 E15 E22 E15 E7 O-9 E24 E24 O33 O-9 O-9 O-11 O2 E-11 E-11 O-17 O-5 O-30 E9 O39 O28 E-2 E0 O10 E3 E8 E13 E17 E-21 E-32 E-26 E-7 E-3 E-5 O12 E2 E16 E20 O-15 E-27 E-23 E-31 O-23 O-24 O-11 O-31 O-7 E27 E35 E23 O17 E30 E16 E20 O7 O10 O7 O12 O1 O3 E9 O4 O30 O43 E34 O29 O29 O-5 E-31 E-26 E-24 E-26 O-18 O-16 O-14 E-6 E-6 O-14 O-15 O-19 O12 O15 E25 E23 O13 O2 E1 E25 O-9 O-12 E-22 E-20 O-10 O1 E2 E-22"
 
gliders=["3o$o$bo!","b2o$2o$2bo!","b2o$bobo$bo!","2bo$b2o$bobo!"]
gliderlist=[g.parse(gl) for gl in gliders]
elbow=g.parse("2o$2o!")
 
g.setrule("Life")
 
def makerecipe(recipe):
  clist = gliderlist[0]
  totaltime=0
  for i in recipe[1:]:
    totaltime+=i
    clist=g.join(clist,g.transform(gliderlist[totaltime%4],totaltime/4,totaltime/4))
  return clist

## find this one -- [-33, -44, '0,93,90,91,91,90,90,154,120,127,90,100,90,147,91,90,91,276,94,93,91,91,90,134,90,90,90,144,90', 0]

data="""Move+14Lane+00:0,109,91,93,91,92,90,97,91,116,91,145,90,91,98,90,90,188,91,91,91,90,115,90
Move-01Lane+00:0,109,91,93,91,92,90,97,91,116,91,145,90,91,98,90,90,188,91,90,90,90
Move+05Lane+01:0,109,91,95,125,128,90,90,90,172,90,90,90,119,91,113,247,90,144,90,140,90
Move-24Lane+01:0,109,91,94,91,91,93,90,95,90,113,90,99,90,156,90,90,90,138,170
Move+02Lane-01:0,109,91,94,91,91,136,90,90,91,171,100,91,91,90,92,96,90,101,90
Move-09Lane-01:0,109,90,95,245,90,95,90,123,91,90,115,142,90
Move+00Lane+02:0,109,91,93,91,92,90,162,90,129,91,91,91,90,137,99,90,90,111,91,153,90,90,90
Move-27Lane+02:0,109,91,94,91,91,124,91,90,91,91,90,91,90,141,90,172,91,161,90,169,228,90
Move+07Lane-02:0,109,91,93,91,92,91,90,90,162,91,91,90,129,91,113,90,90,90,90
Move-23Lane-02:0,93,91,118,91,151,90,99,153,91,90,149,136,91,106,91,90,90,91,136,90
Move+04Lane+03:0,109,91,94,91,91,92,90,169,90,90,90,107,90,90,91,90,95,91,90
Move-34Lane+03:0,109,91,94,91,90,96,90,91,158,90,90,91,93,231,91,91,90,91,90
Move+01Lane-03:0,109,91,93,90,129,148,90,93,90,143,96,92,90,165,90,118,90,90,91,90
Move-09Lane-03:0,109,91,94,91,91,136,90,90,91,168,90,106,90,90,138,90,90,106,90
Move+08Lane+04:0,109,91,94,91,91,141,90,171,91,90,91,107,157,121,90,90,119,90,90
Move-56Lane+04:0,109,91,94,91,91,92,90,169,91,90,116,90,161,91,104,90
Move+03Lane-04:0,109,90,95,245,90,131,135,90,90,154,90,91,91,91,111,90,90,91,91,128,91,96,90
Move-23Lane-04:0,93,91,90,144,90,111,91,92,91,103,91,144,90,168,91,91,102,90,92,90,94,90
Move+08Lane+05:0,109,91,94,91,91,179,91,90,94,91,111,90,90,90,171,91,110,91,154,90,132,90
Move-08Lane+05:0,109,90,93,91,91,135,91,124,90,90,148,91,91,97,141,91,90
Move+05Lane-05:0,109,91,93,91,137,90,166,91,102,90,104,91,96,96,91,90,90,90,166,90,90,93,90,90
Move-20Lane-05:0,109,91,94,91,91,95,91,90,104,90,90,97,91,91,94,191,97,90,126,90
Move+26Lane+06:0,109,91,93,91,129,148,91,93,154,90,134,91,91,90,91,91,111,91,91,91,91,90
Move-15Lane+06:0,93,90,90,90,91,90,91,136,155,98,120,90,90,91,92,90,97,161,161,139
Move+08Lane-06:0,109,91,93,91,127,91,90,97,91,90,104,91,90,90,115,90,103,91,91,99,91,92,90,90
Move-11Lane-06:0,109,91,94,91,90,90,90,90,109,91,101,90,98,90,90
Move+08Lane+07:0,109,91,94,91,91,141,90,171,90,155,90,111,91,90,130,90,91,90,97,90,90
Move-30Lane+07:0,109,91,94,91,91,124,91,105,90,169,91,90,116,91,142,90,90,90
Move+17Lane-07:0,109,91,93,91,145,215,114,91,121,91,150,91,91,153,91,141,90,91,91,90,123,90
Move-34Lane-07:0,109,91,93,91,92,91,98,201,91,129,90,90,90,90,90,103,90,108,90,104,90
Move+08Lane+08:0,109,91,94,91,91,93,90,158,90,91,90,90,116,104
Move-15Lane+08:0,109,91,94,91,90,116,90,90,91,95,91,90,130,90,91,130,208,91,90
Move+01Lane-08:0,93,91,116,90,106,91,143,91,109,90,91,103,110,91,136,91,92,91,155,199
Move-23Lane-08:0,93,91,118,91,151,90,159,91,92,90,136,90,90,154,90,101,104,165,129,90
Move+11Lane+09:0,109,91,93,90,171,90,90,91,90,91,90,91,129,144,90,90,120,90,91,91,169,90,90
Move+05Lane-09:0,109,91,93,91,92,91,90,90,95,102,91,91,91,130,91,90,136,91,91,119,113,90,91,114,90
Move-15Lane-09:0,109,91,94,91,91,90,91,91,90,158,90,91,90,90,101,90,107,90,90,90,90
Move-53Lane+09:0,109,91,94,91,90,99,90,112,90,91,105,90,121,118,103,90,144,117,95,91
Move+14Lane+10:0,109,91,93,90,140,150,108,91,90,111,91,91,194,98,90,169,90
Move-03Lane+10:0,109,91,93,91,173,90,91,90,91,90,101,91,91,91,91,91,96,143,90,91,126
Move+15Lane-10:0,109,91,93,91,97,91,90,91,120,90,95,91,143,90,90,90,90,90
Move-28Lane-10:0,109,91,93,91,97,91,90,91,120,91,117,91,123,90,118,91,146,110,160,90
Move+08Lane+11:0,109,90,93,91,91,181,90,95,110,114,100,160,90,143,91,119,90,106,128
Move-05Lane+11:0,109,91,94,91,91,92,90,146,90,90,90,91,135,91,152,135
Move+14Lane-11:0,109,91,93,90,140,150,142,91,90,111,91,91,193,97,91,91,155,90,98,90,90
Move-53Lane-11:0,93,91,151,90,139,180,103,115,167,91,120,139,135,91,91,169
Move+08Lane+12:0,109,91,94,91,91,121,90,90,90,90,90,90,99,90,165,119,90,106,90,90,90
Move-53Lane+12:0,93,91,116,91,131,91,95,188,113,91,91,147,122,91,173,91,91,133,247,92,90
Move+08Lane-12:0,109,91,94,91,91,124,90,144,90,90,90,165,119,90,104,90,100,90,90,90
Move-23Lane-12:0,109,91,94,91,90,162,122,111,90,90,90,96,91,91,91,122,91,91,171,90
Move+08Lane+13:0,109,91,94,91,91,167,90,90,91,95,90,90,148,90,151,90,90,136,134,155,115,103,90
Move-32Lane+13:0,109,91,94,91,91,96,90,97,91,91,145,90,113,90,90,105,91,193,90
Move+01Lane-13:0,109,91,93,91,92,90,158,90,94,270,172,130,90,91,91,96,90,90,147,90
Move-21Lane-13:0,109,91,93,91,169,90,90,152,127,90,91,90,92,90,93,91,171,90,146,90
Move+01Lane+14:0,109,91,93,90,140,151,145,91,94,90,90,113,91,93,91,90,93,90,100,91,99,90,91,99,90
Move-16Lane+14:0,109,91,93,91,129,149,91,90,90,142,219,90,99,91,109,115,92,185,90
Move+08Lane-14:0,109,91,94,91,91,164,91,133,124,90,90,124,90,90,91,90,90,112,91,138,91,118,90,90
Move-39Lane-14:0,109,91,93,91,155,106,91,91,96,90,90,91,108,90,156,90,90,120,90,112,91,99,90
Move+09Lane+15:0,109,90,93,91,91,158,94,113,91,90,91,96,90,142,90
Move-21Lane+15:0,109,90,93,91,91,142,90,98,90,91,125,114,127,90,111,90
Move+13Lane-15:0,109,91,93,90,156,91,91,94,91,90,147,117,91,144,90,91,128,100,91,90,105,91,90
Move-33Lane-15:0,109,91,94,91,91,171,91,90,113,90,97,114,90,105,90,139,90,113,90,106,98,121,90
Move+08Lane+16:0,109,91,94,91,91,95,91,90,93,218,172,90,90,90,116,112,341,107,106,90,163,91,90
Move-08Lane+16:0,109,91,94,91,90,152,91,90,91,117,90,91,111,91,91,118,90,145,90,100,116,90,90,99,90
Move+08Lane-16:0,109,91,94,91,91,124,91,126,91,140,162,148,90,90,119,90,90
Move-23Lane-16:0,109,91,93,91,97,90,90,102,91,91,116,93,90,112,90,109,91,147,91,90
Move+01Lane+17:0,109,91,93,90,155,106,91,121,90,90,91,137,90,232,90,91,91,94,90,171,90,91,103,101
Move-28Lane+17:0,109,91,94,91,91,96,90,166,91,91,114,90,90,91,90,90,114,91,101,90
Move+03Lane-17:0,109,91,93,91,123,90,129,91,90,104,157,90,171,91,90,90,90,90,164,94
Move-22Lane-17:0,109,91,93,91,123,90,129,90,90,111,142,91,90,120,91,142,98
Move+01Lane+18:0,109,90,93,91,91,148,91,90,151,90,91,163,108,151,112,144,90,149,90,90,99,90
Move-20Lane+18:0,109,91,93,91,97,90,91,111,91,116,91,94,330,91,90,95,91,90,90,91,123,90,91,152,90,90
Move+08Lane-18:0,109,90,93,91,91,128,91,91,90,97,90,99,90,139,91,91,117,134,92,90,90,90,90
Move-32Lane-18:0,109,91,93,90,123,91,103,90,91,119,90,90,172,166,90,90,138,90,95,91,90,90,96,90
Move+08Lane+19:0,109,91,94,91,91,153,91,91,91,90,90,91,158,91,91,166,90,91,91,90
Move-19Lane+19:0,109,91,93,91,115,107,90,90,90,90,90,90,90,103,99,118,91,130,90
Move+26Lane-19:0,109,91,93,91,130,91,90,134,90,90,103,122,156,112,90,183,117,91,152,141,90,98,90,90
Move-20Lane-19:0,109,91,93,91,171,91,90,90,94,91,106,91,91,90,90,143,90,91,91,91,90,91,112,90
Move+12Lane+20:0,109,91,93,90,169,90,91,103,91,133,90,90,91,91,90,110,91,93,90,112,171,90
Move-02Lane+20:0,109,91,94,91,91,128,126,90,161,151,90,109,91,90,90,94,144,106,90,94,90,90,90
Move+08Lane-20:0,109,91,94,91,91,95,91,90,150,90,140,90,91,90,171,90,118,91,111,90,104,90
Move-29Lane-20:0,93,90,91,91,90,90,91,90,103,113,91,103,90,152,181,140,91,90,166,91,106
Move+03Lane+21:0,109,91,94,91,91,136,91,91,90,168,90,90,110,90,90,93,91,111,91,91,90,132,91,90
Move-02Lane+21:0,109,91,93,91,120,91,91,91,91,90,91,100,91,90,97,91,91,90,90,160
Move+08Lane-21:0,109,91,94,91,91,95,91,90,146,91,99,90,118,120,135,90,90,121,90
Move-02Lane-21:0,109,91,94,91,91,95,91,90,146,91,99,90,118,120,135,90,90,118,90,90
Move+27Lane+22:0,109,91,94,91,91,93,90,91,91,90,100,90,94,90,108,90,91,91,119,90
Move-03Lane+22:0,109,91,94,91,91,93,90,91,91,90,100,90,94,90,108,92,90,90,91,123,90,91,90
Move+06Lane-22:0,109,91,94,91,91,179,91,90,94,91,114,90,166,90,90,90,91,117,90,96,90,90,95,91,90
Move-20Lane-22:0,109,91,94,91,91,136,90,90,91,114,90,91,90,99,90,97,90,90,90,126,90,137,90,90
Move+08Lane+23:0,109,91,94,91,91,124,90,170,90,90,91,90,99,91,90,91,110,121,161,117,115,137,90,91,90
Move-01Lane+23:0,109,91,93,90,132,115,166,90,90,90,91,91,161,115,91,96,91,96,116,122,90,121,236,92,99,92,90
Move+08Lane-23:0,109,91,94,91,91,95,91,90,97,143,171,90,105,90,91,144,91,90,90,90,94,90,90,90
Move-08Lane-23:0,109,91,93,90,156,91,91,102,91,91,90,90,106,91,166,90,125,91,90,126,90
Move+09Lane+24:0,109,91,93,91,123,90,147,90,91,90,140,91,94,91,152,91,90,91,106,91,135,90,98,146,90,90
Move-11Lane+24:0,109,91,93,91,92,91,139,90,91,91,90,96,130,97,91,164,90,97,91,90,91,114,90,90,118,90,90
Move+08Lane-24:0,109,91,94,91,91,179,91,90,94,91,102,91,151,90,90,101,90,91,125,184,90,90,90
Move-43Lane-24:0,109,91,93,91,129,148,91,93,154,91,91,90,90,90,91,112,90,95,90,97,90,90,113,90
Move+07Lane+25:0,93,91,116,91,106,91,155,90,106,90,167,90,90,91,148,123,111,155,91,105,90,90,92,90,124,90,90
Move-20Lane+25:0,109,91,93,91,117,90,91,90,163,91,117,91,136,90,114,300,91,91,130,90,142,90,91,94,90
Move+42Lane-25:0,109,90,93,91,90,95,91,91,139,90,147,90,90,99,117,91,157,91,126,90,90,91,160,90,91,91,91,111,90,90,113,90,90
Move-06Lane-25:0,109,91,94,91,90,164,91,148,90,90,90,90,115,153,91,92,90,90,91,90,109,109,90
Move+11Lane+26:0,109,91,94,91,91,95,91,90,93,218,142,90,91,161,90,138,90,162,91,90,140,95,108
Move-32Lane+26:0,109,91,93,90,129,149,91,90,90,97,131,91,90,119,90,90,90,90,90,156,121,162,90,90,93,163
Move+05Lane-26:0,123,270,90,125,90,90,90,94,137,123,90,145,136,90,91,100,91,105,91,153,91,90,145,155
Move-09Lane-26:0,109,91,94,91,90,116,90,90,91,95,90,97,90,90,147,90,124,96,265,90,91,96,91,91,139,91,96,90
Move+08Lane+27:0,109,91,94,91,91,124,90,142,90,90,146,91,153,90,102,91,152,108,97,90
Move-24Lane+27:0,109,91,93,90,123,91,133,90,103,129,112,91,132,91,95,219,95,97,90,167,90
Move+37Lane-27:0,109,90,101,169,213,133,195,90,132,143,91,139,138,158,151,99,91,108,99,91,90,91,91,90,91,131,90
Move-04Lane-27:0,109,91,94,91,91,96,90,112,91,143,91,90,91,145,97,195,127,136,116,91,90,90,96,187,90,90
Move+06Lane+28:0,109,91,93,91,92,91,90,90,124,91,142,90,90,91,91,112,90,102,102,103,90,90,90,117,112,90,189,90,90
Move+16Lane-28:0,109,91,95,125,112,91,121,120,90,90,90,90,138,90,100,90,143,91,90,129,90,123,119,90
Move-32Lane+28:0,93,91,116,90,151,90,113,91,100,90,141,90,90,147,230,91,92,90,91,112,134,90,145,91,258
Move-27Lane-28:0,109,91,95,125,112,91,121,113,91,90,91,90,148,90,90,91,126,103,91,99,302,170,90,91,90
Move+01Lane+29:0,109,91,94,91,91,149,102,90,156,90,170,91,136,91,182,90,90,91,91,128,90,91,91,99,91,90,90
Move+12Lane-29:0,109,91,93,91,123,91,118,90,91,108,91,91,90,90,90,90,143,91,92,177,129,101,167,91,90,90,91,130,127,90,137,90
Move-34Lane+29:0,109,91,94,91,91,149,102,90,156,90,170,91,119,211,91,90,91,93,108,103,90
Move-23Lane-29:0,93,90,91,91,94,229,107,91,90,104,91,91,101,91,91,93,90,119,90,133,90,91,93,145,91,132,90
Move+07Lane+30:0,109,91,94,91,91,124,91,105,91,119,91,132,99,90,90,90,150,160,116,91,91,91,90,96,90,90
Move+15Lane-30:0,109,91,93,90,129,148,91,102,91,91,145,178,91,115,90,90,91,104,90,90,92,249,90,90,90
Move-21Lane+30:0,109,91,94,91,91,124,91,144,90,119,91,144,90,90,141,90,90,90,90,90,145,90,142,158,90
Move-15Lane-30:0,109,91,93,91,129,148,91,102,91,91,145,178,91,144,95,91,90,107,90,90,154,91,90,193
Move+13Lane+31:0,109,90,93,91,91,128,90,139,91,90,97,91,124,157,91,90,90,129,144,91,91,147,130,91,90,90,91,90,140,90,92,90,90
Move+32Lane-31:0,109,91,101,169,213,133,196,91,133,151,90,109,90,98,121,138,93,91,109,91,93,90,153,143,90,112,176,90,143,90
Move-06Lane+31:0,93,91,109,90,160,158,91,112,103,95,92,147,157,141,137,91,90,90,90,90,109,91,90,135,91,91,101,166,91,97,128,90
Move-49Lane-31:0,124,126,90,142,91,117,90,113,90,103,90,91,91,91,122,91,90,91,119,91,135,91,140,260,90
Move+23Lane+32:0,109,91,93,90,123,91,130,99,153,107,104,133,90,119,90,90,101,172,90,125,90,91,90,90,90
Move+04Lane-32:0,93,91,118,90,137,91,173,93,158,90,90,90,118,90,91,90,151,154,167,91,101,149,115,90,95,260,213,112,90
Move-22Lane+32:0,109,91,93,91,123,91,130,99,153,107,170,91,109,91,126,90,126,101,91,93,90,91,159,90
Move-13Lane-32:0,93,91,118,90,137,91,173,93,158,90,90,90,118,90,91,90,151,154,167,91,133,90,119,178,155,90,90,90
Move+02Lane+33:0,109,91,93,91,130,91,90,110,90,154,91,90,90,158,91,98,137,90,90,106,90,106,90,90,90
Move+32Lane-33:0,109,91,93,90,140,150,132,212,103,90,98,90,148,90,90,91,91,91,119,101,108,90,91,91,119,90
Move-36Lane+33:0,109,91,93,91,130,91,90,110,90,90,102,102,163,91,90,94,91,153,223,146,171,90,122,91,90,90
Move-44Lane-33:0,93,90,91,91,90,90,154,120,127,90,100,90,147,91,90,91,276,94,93,91,91,90,134,90,90,90,144,108
Move+01Lane+34:0,109,91,94,91,90,95,91,90,147,167,90,160,90,160,104,90,90,91,91,101,139,91,90,136,129,90
Move+26Lane-34:0,93,91,166,130,90,90,113,91,90,97,169,122,91,109,112,109,91,90,119,91,105,225,90,90,136,90,151,91,90,90,134,90
Move-39Lane+34:0,109,91,94,91,90,95,91,90,147,167,91,104,149,126,91,108,91,90,152,90,103,91,192,102,90
Move-30Lane-34:0,93,91,166,130,90,90,113,91,90,97,169,122,91,109,112,109,91,90,157,91,90,123,136,90,111,91,130,116,91,91,169,90,90
Move+00Lane+35:0,109,91,93,90,156,91,91,96,132,91,91,106,91,90,106,198,91,95,90,100,90,96,129,126,91,121,91,90
Move+27Lane-35:0,109,91,93,90,140,150,132,212,105,90,98,91,97,90,90,134,125,163,91,93,90,101,91,90,90
Move-34Lane+35:0,109,91,93,90,156,91,91,96,132,91,91,106,91,90,119,185,91,96,90,132,90,91,90,142
Move-04Lane-35:0,109,91,93,90,137,90,145,90,160,91,148,178,90,93,90,123,91,118,122,91,163,126,103,159,100,120
Move+08Lane+36:0,109,91,93,90,155,106,91,131,97,96,151,90,90,159,151,90,90,91,93,90,140,90,91,149,136
Move+07Lane-36composite:0,109,91,94,91,90,96,90,91,146,240,109,91,93,90,155,106,91,131,97,96,151,90,90,159,151,90,90,91,93,90,140,90,91,149,136
Move-04Lane+36:0,109,91,93,90,155,106,91,131,97,96,150,99,90,105,90,169,90,91,126,106,104,136,111,91,115,90
Move-27Lane-36:0,109,91,93,91,123,91,103,91,90,132,139,90,124,90,91,91,158,91,171,254,91,148,176,90,131,91,90,125,91,90,104,90
Move+09Lane+37:0,124,126,90,94,90,126,128,140,115,121,142,103,91,119,214,118,91,112,170,90,90,90,91,91,90
Move+19Lane-37:0,109,91,93,90,140,150,143,91,104,91,90,91,106,109,91,99,90,90,118,160,90,99,104,214,122,91,91,181,91,90,90,167,90,96,90
Move-26Lane+37:0,109,91,94,91,91,93,90,125,90,170,90,90,90,169,179,91,160,91,91,90,132,91,131,90,90
Move-47Lane-37:0,93,91,109,90,106,210,91,90,151,90,137,90,91,118,90,96,91,90,129,126,169,233,155,90,148,131,90,100,91,90,90,90,91,90,90
Move+04Lane+38:0,93,91,109,90,106,210,141,164,90,94,144,90,91,91,94,133,120,90,91,147,91,90,108,90,124,175,148,91,90,90
Move+05Lane-38:0,109,91,93,91,137,90,110,249,109,91,90,164,90,90,91,92,91,90,90,110,108,128,91,91,90,91,131,104,90,97,91,90
Move-21Lane+38:0,93,91,109,90,106,210,141,164,90,94,144,90,91,115,180,90,133,119,131,100,154,148,175,127,196,116,90
Move-29Lane-38:0,109,91,93,90,137,90,110,249,91,91,103,93,91,90,90,148,91,96,237,163,91,112,91,150,91,91,100,121
Move+02Lane+39:0,93,91,109,90,137,91,90,126,90,115,106,119,119,90,118,90,145,153,90,108,91,91,91,135,91,112,103,118,121
Move+01Lane-39:0,109,91,93,91,118,90,91,91,91,104,219,91,135,105,154,90,91,164,91,132,90,90,140,94,93,90,96,90,90,91,149,90,90,161,99
Move-13Lane+39:0,93,91,109,90,137,91,90,126,90,115,106,135,91,90,90,173,90,121,90,90,90,91,91,101,116,91,90
Move-14Lane-39composite:0,109,91,94,91,90,96,90,91,146,240,93,91,109,90,137,91,90,126,90,115,106,135,91,90,90,173,90,121,90,90,90,91,91,101,116,91,90
Move+03Lane+40:0,109,91,93,90,171,90,91,90,151,90,111,91,146,234,91,90,90,172,90,159,118,91,301,90,90,91,91,90,100,90,155,127,101,90
Move+33Lane-40:0,109,91,93,91,120,90,90,100,90,90,111,178,102,184,90,104,136,91,141,97,218,158,91,104,90,141,90,90,90
Move-51Lane+40:0,109,91,93,91,171,91,90,90,151,90,111,91,146,234,90,91,145,91,90,91,103,90,94,150,141
Move-53Lane-40:0,109,91,93,91,92,91,144,91,91,155,91,96,91,92,90,101,90,160,90,97,158,108,91,169,97,90,123,90
Move+00Lane+41composite:0,109,91,94,91,90,96,90,91,146,240,109,90,93,91,91,107,90,98,108,102,111,91,91,90,149,91,90,90,92,90,95,90,91,90,151,90,90
Move+01Lane-41:0,109,90,93,91,91,107,90,98,108,102,111,91,91,90,149,91,90,90,92,90,95,90,91,90,151,90,90
Move-02Lane+41composite:0,109,91,94,91,90,96,90,91,146,240,109,90,93,91,91,107,90,98,108,102,111,105,91,104,90,104,90,90,90,91,90,91,90,116,90,90
Move-01Lane-41:0,109,90,93,91,91,107,90,98,108,102,111,105,91,104,90,104,90,90,90,91,90,91,90,116,90,90
Move+17Lane+42:0,109,91,93,90,155,106,91,232,155,211,162,129,110,91,90,91,134,90,116,295,172,91,91,91,90,92,90,90
Move+17Lane-42:0,109,91,93,91,123,91,133,91,95,91,143,91,112,90,91,110,91,90,90,91,91,107,90,98,112,91,184,90,90
Move-29Lane+42:0,109,91,93,90,155,106,91,232,158,91,120,225,121,91,157,235,135,91,165,103,113,90,90,141,121,143,90
Move-06Lane-42:0,109,91,93,91,123,91,133,91,95,91,143,91,112,90,90,106,91,145,91,96,90,97,90,153,91,90,90,91,125,90,101,90
Move+26Lane+43:0,109,91,93,90,140,150,149,91,92,129,90,91,90,114,90,90,90,93,90,90,170,122,90,91,126,90,91,90,158,142,91,90
Move+29Lane-43:0,109,90,93,91,91,98,90,90,100,90,90,96,90,97,163,90,98,229,117,90,104,91,91,90,90,109,91,90
Move-19Lane+43:0,109,91,93,90,140,150,149,91,92,129,90,91,90,125,91,91,90,125,91,118,266,90,91,115,143,133,102,90,133,94,92,90,90
Move-13Lane-43:0,93,91,116,91,151,90,109,111,127,91,113,91,169,186,90,90,158,91,90,90,90,117,91,160,90,91,96,90,90,90
Move+05Lane+44:0,109,91,93,90,156,91,91,94,91,90,138,91,115,129,98,91,91,129,251,140,91,90,91,160,90,91,90,124,90,97,90,90,152,91,90
Move+07Lane-44:0,93,91,90,144,90,100,186,119,91,90,90,90,171,163,122,103,125,90,113,99,91,126,202,90,160,124,123,90,142,91,125,121
Move-13Lane+44:0,109,91,94,91,91,128,126,91,105,91,103,90,90,190,103,238,96,129,91,90,133,90,91,129,90,91,91,97,90,90
Move-05Lane-44:0,93,91,90,144,90,100,186,119,91,90,90,90,171,163,122,103,125,91,113,99,90,107,91,90,90,90,113,91,119,126,105,90
Move+14Lane+45:0,109,90,95,245,90,118,91,91,91,152,91,120,91,91,101,91,112,111,90,90,93,111,90,107,90,90,90,122,142,165,91,90,90
Move+16Lane-45:0,109,90,93,91,91,117,90,122,91,127,90,90,130,202,91,168,91,91,94,91,133,90,120,91,91,159,91,104,90,109,94
Move-13Lane+45:0,109,91,93,90,129,148,91,93,154,90,91,90,104,114,90,90,98,90,91,170,91,105,226,91,93,91,109,90,92,91,90,115,262,90
Move-21Lane-45:0,109,90,93,91,91,117,90,122,91,127,90,91,143,221,91,90,112,151,156,171,97,146,90,144,91,91,91,148,90
Move+07Lane+46:0,109,91,93,91,169,90,90,135,90,103,98,119,91,90,106,117,90,106,90,90,91,120,257,104,91,91,91,91,159,91,90
Move+15Lane-46:0,109,91,94,91,91,92,90,113,90,90,153,115,90,91,94,145,165,91,96,294,91,91,94,91,90,91,103,210,131,90,91,90,90,90
Move-24Lane+46:0,109,91,93,90,109,91,91,91,158,91,96,116,91,132,90,136,143,90,90,133,104,152,90,93,135,90,91,90
Move-11Lane-46:0,109,91,94,91,91,92,90,113,90,90,153,93,91,121,252,153,91,91,132,121,91,132,90,138,97,91,91,164,122,97,126,123,90,114,90
Move+00Lane+47:0,109,91,94,91,90,136,90,91,90,155,90,109,98,90,121,139,125,90,91,170,105,133,91,91,95,91,112,90,122,91,128,90,135,90,109,132
Move+1Lane-47composite:0,109,91,94,91,91,92,90,143,90,91,156,90,104,164,109,91,94,91,90,136,90,91,90,155,90,109,98,90,121,139,125,90,91,170,105,133,91,91,95,91,112,90,122,91,128,90,135,90,109,132
Move-29Lane+47:0,109,91,94,91,90,136,90,91,90,155,90,134,91,112,91,91,113,100,116,90,113,91,113,91,91,90,140,91,157,90
Move-30Lane-47composite:0,109,91,94,91,90,96,90,91,146,240,109,91,94,91,90,136,90,91,90,155,90,134,91,112,91,91,113,100,116,90,113,91,113,91,91,90,140,91,157,90
Move+11Lane+48:0,93,91,118,91,151,90,148,92,116,90,118,92,90,90,91,128,90,133,153,90,91,144,91,90,128,125,90,226,90
Move+14Lane-48:0,109,90,93,91,91,133,91,91,111,90,90,90,147,91,111,149,102,90,97,114,153,91,132,91,151,189,103,148,105
Move-22Lane+48:0,93,91,118,91,151,90,148,92,116,90,93,90,90,136,91,111,147,164,90,91,91,90,90,91,113,99,115,91,136,90,90
Move-09Lane-48:0,109,90,93,91,91,133,91,90,134,90,97,114,159,90,90,134,91,91,168,90,91,91,102,90,97,90,167,90,90,90
Move+08Lane+49:0,109,91,93,90,129,148,90,152,306,90,104,91,129,90,157,99,124,96,90,92,130,151,91,91,90,90,275,90,442,98,512
Move+05Lane-49:0,109,91,93,90,130,91,90,90,91,91,173,91,111,152,100,91,91,119,90,132,91,125,90,160,128,106,90,115,91,90,136,90
Move-39Lane+49:0,109,91,93,90,129,148,90,152,306,90,104,91,129,90,100,295,91,137,90,91,90,91,91,118,513,390,90,90,90,90
Move-22Lane-49:0,109,91,93,90,130,91,90,90,91,91,155,90,90,118,90,91,140,98,169,90,144,90,142,91,96,91,90,167,90
Move+01Lane+50composite:0,109,91,94,91,90,96,90,91,146,240,109,91,94,91,91,93,90,97,91,91,161,90,91,90,91,90,99,90,90,99,91,90,133,91,114,91,99,90,100,93
Move+02Lane-50:0,109,91,94,91,91,93,90,97,91,91,161,90,91,90,91,90,99,90,90,99,91,90,133,91,114,91,99,90,100,93
Move-23Lane+50composite:0,109,91,94,91,90,96,90,91,146,240,109,91,94,91,91,93,90,97,91,91,115,98,180,135,90,93,91,112,90,125,90,90,126,102,124,100,138,91,154,90
Move-22Lane-50:0,109,91,94,91,91,93,90,97,91,91,115,98,180,135,90,93,91,112,90,125,90,90,126,102,124,100,138,91,154,90
Move+03Lane+51composite:0,109,91,94,91,90,96,90,91,146,240,93,91,109,90,107,90,91,121,151,109,97,126,91,90,90,90,90,115,91,163,90,115,177,95,90,219,119,91,114,90,105,90
Move+04Lane-51:0,93,91,109,90,107,90,91,121,151,109,97,126,91,90,90,90,90,115,91,163,90,115,177,95,90,219,119,91,114,90,105,90
Move-31Lane+51composite:0,109,91,94,91,90,96,90,91,146,240,93,91,109,90,107,90,91,121,151,109,97,150,90,90,101,276,100,248,120,90,135,156,222,107,91,90,121,91,91,90
Move-30Lane-51:0,93,91,109,90,107,90,91,121,151,109,97,150,90,90,101,276,100,248,120,90,135,156,222,107,91,90,121,91,91,90
Move+16Lane+52:0,109,91,93,91,164,90,91,90,154,123,112,90,91,91,90,90,90,91,133,154,90,97,91,91,114,91,91,166,91,100,90,90
Move+37Lane-52:0,109,91,101,169,213,133,196,90,133,178,147,102,91,170,109,91,91,90,91,91,93,91,90,101,126,90,91,91,91,91,91,91,91,90
Move-02Lane+52:0,109,90,101,169,213,133,195,91,133,178,138,91,90,128,91,167,160,121,96,91,112,91,92,112,90,90,103,118,90,100,90
Move-36Lane-52:0,124,126,90,94,90,122,91,91,102,90,160,91,134,91,122,162,139,90,97,158,141,90,150,93,90,122,91,92,90,90,90,90
Move+05Lane+53:0,109,90,101,169,213,133,195,90,133,111,121,96,170,91,91,90,130,90,111,90,124,91,108,194,156,90,121,90,125,90,91,130,91,110,90
Move+32Lane-53:0,109,91,93,91,121,90,90,95,144,90,91,163,127,108,115,165,91,90,91,90,90,91,90,111,98,106,91,154,90,90,90,165,117,90,90,120
Move-01Lane+53:0,109,91,93,91,92,91,128,91,90,129,91,90,90,90,160,91,145,91,90,90,146,91,169,90,90,121,166,90,134,90,141,93,106,90,90
Move-02Lane-53composite:0,109,91,94,91,90,96,90,91,146,240,109,91,93,91,92,91,128,91,90,129,91,90,90,90,160,91,145,91,90,90,146,91,169,90,90,121,166,90,134,90,141,93,106,90,90
Move+20Lane+54:0,93,91,166,157,97,184,91,127,194,150,90,107,141,99,90,91,90,111,91,154,91,90,117,199,132,157,121,91,172,90,114,90,94,90
Move+19Lane-54composite:0,109,91,94,91,90,96,90,91,146,240,93,91,166,157,97,184,91,127,194,150,90,107,141,99,90,91,90,111,91,154,91,90,117,199,132,157,121,91,172,90,114,90,94,90
Move-21Lane+54:0,93,91,166,157,97,184,91,127,194,150,90,107,141,169,91,132,296,90,95,241,91,90,90,132,132,90,101,91,90,91,102,90
Move-22Lane-54composite:0,109,91,94,91,90,96,90,91,146,240,93,91,166,157,97,184,91,127,194,150,90,107,141,169,91,132,296,90,95,241,91,90,90,132,132,90,101,91,90,91,102,90
Move+02Lane+55:0,109,91,94,91,91,124,90,137,106,106,122,107,91,90,155,90,170,91,90,165,90,125,179,90,90,157,122,142,90,90,90
Move+01Lane-55:0,109,90,93,91,91,167,116,97,195,116,90,146,91,104,90,117,227,120,137,156,90,124,90,156,93,118,90,248,99,91,137,142,90,90
Move-13Lane+55:0,109,91,94,91,91,136,90,90,90,98,91,147,91,91,140,91,91,231,128,91,95,170,90,90,128,91,115,90
Move-47Lane-55:0,109,91,95,124,104,127,108,105,170,271,97,90,149,217,95,91,90,172,106,138,91,114,90,90,91,90,145,171,90,150
Move+09Lane+56:0,109,91,94,91,91,93,90,112,91,148,142,91,171,90,90,90,159,91,90,119,91,90,141,304,137,90,91,91,90,130,159,91,90,113,102
Move+08Lane-56composite:0,109,91,94,91,90,96,90,91,146,240,109,91,94,91,91,93,90,112,91,148,142,91,171,90,90,90,159,91,90,119,91,90,141,304,137,90,91,91,90,130,159,91,90,113,102
Move-02Lane+56:0,93,91,163,224,90,105,90,111,91,91,113,110,114,144,90,91,209,90,171,90,93,200,90,157,91,123,90,103,90,116,90
Move-07Lane-56:0,93,91,118,90,151,90,130,315,111,163,153,91,130,115,90,113,208,104,91,106,91,91,90,91,116,90,142,139,156,247,152,90
Move+01Lane+57:0,109,91,93,91,138,120,113,91,90,90,105,91,142,91,102,112,90,164,90,91,97,99,120,164,90,134,90,120,90,172,90,90
Move+00Lane-57:0,124,126,90,142,91,99,135,108,90,99,90,135,90,164,175,154,91,107,144,90,129,91,107,90,90,110,90,90,127,90,90,90,122,90,167,90
Move-40Lane+57:0,109,91,93,91,138,120,150,143,91,97,90,106,161,122,229,122,165,91,119,96,114,90,131,91,90,91,90
Move-31Lane-57:0,124,126,90,142,91,99,135,108,90,99,90,135,90,164,175,154,91,107,144,90,129,91,163,90,90,114,247,90,147,130,91,90,118,90
Move+07Lane+58:0,109,90,93,91,91,153,91,90,91,99,90,161,90,150,91,90,126,97,99,90,148,90,100,196,117,91,90,90,91,121,91,90,157,145,90
Move+06Lane-58composite:0,109,91,94,91,90,96,90,91,146,240,109,90,93,91,91,153,91,90,91,99,90,161,90,150,91,90,126,97,99,90,148,90,100,196,117,91,90,90,91,121,91,90,157,145,90
Move-19Lane+58:0,109,90,93,91,91,153,91,90,91,99,90,161,90,153,91,100,91,92,90,147,91,90,90,125,91,105,141,90,90,91,90,90,118,90,90
Move-35Lane-58:0,93,91,116,91,140,91,142,95,102,97,135,302,91,90,90,142,91,117,91,106,91,96,108,98,139,91,91,163,91,91,90,90,128,109,150,90
Move+06Lane+59composite:0,109,91,94,91,90,96,90,91,146,240,93,91,151,91,131,153,113,91,91,141,100,90,119,295,90,116,117,159,91,90,91,135,191,97,91,113,91,91,157,90,136,150,90,170,90,90
Move+07Lane-59:0,93,91,151,91,131,153,113,91,91,141,100,90,119,295,90,116,117,159,91,90,91,135,191,97,91,113,91,91,157,90,136,150,90,170,90,90
Move-07Lane+59composite:0,109,91,94,91,90,96,90,91,146,240,93,91,151,91,131,153,113,91,91,141,100,90,119,295,90,131,129,99,90,117,132,90,91,142,90,92,223,94,90,144,91,136,91,116,90
Move-06Lane-59:0,93,91,151,91,131,153,113,91,91,141,100,90,119,295,90,131,129,99,90,117,132,90,91,142,90,92,223,94,90,144,91,136,91,116,90"""
parities="OOOEEOOEOOEEOEEEEEEOOOOOOEEEOEEEOEOOEEEEEEOEEOOOOOEEOOEEOOEEEOEOOEEOEEEEOEOEEOOOEOEOOOEEEOOOEEEOOOOEOEEEEEEOEEOOOOEEEEOEOOOOEOEOOOOEOEEOEOOEOOEEEEOOEOEEEOEEEEOOEOOOOOEEEEOEOOOEEEOEEEOEOEEEEEEEEEOEOEOOOOEEEEOEEEEEOOOOOOEOEOEEEEEEEEOOOEEEEE"
# Move-47Lane-55:0,109,91,95,124,104,127,108,105,170,271,97,90,149,217,95,91,90,172,106,138,91,114,90,90,91,90,145,171,90,100
#   was a problem -- had to change last number to 150
# TODO: try re-optimizing that one recipe, see if the same mis-optimization occurs, figure out why
# Similar problem with
# Move-44Lane-33:0,93,90,91,91,90,90,154,120,127,90,100,90,147,91,90,91,276,94,93,91,91,90,134,90,90,90,144,90 -- needs to end in "118"
datalist=data.replace("composite","").split("\n")
negdict,posdict={},{}
for d in datalist:
  name,recipe = d.split(":")
  parity=1 if parities[0]=="O" else 0
  parities=parities[1:]
# used the following code to collect parity information
#  cells = g.join(elbow,g.transform(makerecipe(eval("["+recipe+"]")),5,2))
#  g.new("")
#  g.putcells(cells)
#  result = g.evolve(cells,8192)
# -- just for 0-degree gliders in this orientation,
# -- the phase will be even if the first cell in the NW corner of the bounding box is ON --
#  s+="E" if min(result[::2])==result[0] and min(result[1::2])==result[1] else "O"
  if name[:4]!="Move": g.exit("Bad data.  " + name)
  move,lane = name[4:].split("Lane")
  if move[0]=="-":
    negdict[int(lane)] = [int(move),recipe,parity]
  elif move[0]=="+":
    posdict[int(lane)] = [int(move),recipe,parity]
  else:
    g.exit("Bad data. " + d)
 
output=[0]
elbowloc=0
inputlist=inputstr.split(" ")
input=[]
total=0
for s in inputlist:
  parity=1 if s[0]=="O" else 0
  input+=[[int(s[1:]),parity]]
for i,p in input:
  if elbowloc%2==0: # which recipe to use depends on current elbow chirality
    targetlane = i
  else:
    targetlane = -i
  if elbowloc<-48: # -32 doesn't work for the end of the recipe
    move,recipe,parity = posdict[targetlane]
  else:
    move,recipe,parity = negdict[targetlane]
  elbowloc+=move
  adjustedrecipe = recipe[2:] # skip the initial "0"
#  g.note(str([targetlane, move, recipe, parity]))
  if (total+parity+p)%2==1:
    # change the last number in the previous recipe, to flip the parity of the current recipe
    output[-1]+=1
    total+=1
  # now add the current recipe to the total
  for s in adjustedrecipe.split(","): total+=int(s)

  output+=eval("["+adjustedrecipe+"]")
 
# build the resulting recipe and display in a new layer
 
g.setclipstr(str(output).replace("["," ").replace("]","").replace(" ",""))
pat=makerecipe(output[:-1])
g.addlayer()
g.putcells(g.join(elbow,g.transform(pat,5,2)))
g.setalgo("HashLife")
